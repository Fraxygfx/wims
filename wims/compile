#! /bin/sh

if [ "$(id -ru)" = 0 ]; then
 cat <<@
You are trying to compile WIMS as 'root'. You should not do that !
Please compile as 'wims'.
@
 exit 1
fi

##########################################################################
cat <<@
Welcome to the compilation of WIMS (WWW Interactive Multipurpose Server)

@

cd `dirname $0`
cd src
if [ -f ../.wims_maintainer_mode ]; then
  if (autoconf); then :; else
    echo "[maintainer mode] Please install autoconf first."
    exit 1
  fi
  autoheader
fi
./configure || exit
make clean || exit
make all || exit

if [ -f ../.wims_maintainer_mode ]; then
  make maintainer || exit
### to decomment : all the maintainers should have ant ??
 #cd Misc ; make maintainer || exit
  cd ..
fi
cd ..
cat <<@

Please run './bin/setwrapexec' as root (e.g. using sudo) to finish WIMS setup.
See README about installation of help and teaching modules.

@
