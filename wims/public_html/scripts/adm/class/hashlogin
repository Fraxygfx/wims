## INPUT; identifier, class
## OUTPUT : wims compatible unique identifier, compatible with class
## FIXME : if some ldap_field has been defined as 
!distribute items $wims_read_parm into login,cl
!set limit=2
!set limit_while=$[10^$limit]
!read adm/class/authchars
!set login=!lower $login

!set login=!text select $char_alnum in $login
!set login=!char 1 to $[$login_max -$limit] of $login
!set login=!char 1 to $[16-$limit] of $login
!!set cl=!replace internal / by , in $cl
!set cl=$(cl[1])
!if $cl=$empty
  !reset login
  !exit
!endif
###FIXME Utiliser adm/class/userisinclass script_reply
  cnt=0
  user_exists=yes
  login_init=$login
  !while $user_exists=yes and $cnt<$limit_while
      !if $cnt>0
        login=$login_init$cnt
      !endif
      !read adm/class/userdef classes,$cl,$login
      !set user_exists=!getdef user_exists in $userdef
      !increase cnt
  !endwhile
  !if $cnt>=$limit_while
    !reset login
  !endif

