
!if $error!=$empty
 !exit
!endif

!if $no_selection!=$empty
 <b>Attention</b>. Nothing is selected for restoration.
 <p>
!endif

!if $serial!=$wims_class and $old_testcnt>0
 !set test=bad
!endif
!if $test=bad
 <blink><font color=red><b>WARNING!!!</b></font></blink>
 You have uploaded resources backed up from another class. If you
 restore incompatible resources to your class, it will simply be destroyed.
 !href cmd=help&special_parm=dependencies Why?
 <p>
 !href cmd=reply&job=list Stop
 if you are not completely sure of what you are doing. (In any case, keep a
 backup of the current status before continuing.)
 <p><hr> <p> 
!endif

!set no_restore=Cannot be restored because you are sharing resources of\
	another class. Restoration can only be done on the class originating\
	the sharing.
!form reply
<input type=hidden name=job value=$job>
<input type=hidden name=job2 value=restore>
Your backup file <tt>$wims_deposit</tt> contains the following resources.
Please check those you want to restore to your class.
<ul>
 <li><input type=checkbox name=selection value=all>
 Restore everything except class configuration and supervisor account.
!if $new_defcnt>0
 <li><input type=checkbox name=selection value=def>
 Class configuration setup.
 <font color=red>Danger!</font> <small>See notes below.</small>
!endif
!if $new_supcnt>0
 <li>
 !if $sharing_sup=$empty
  <input type=checkbox name=selection value=sup>
 !endif
 Supervisor account (including your password).
 !if $sharing_sup!=$empty
  $no_restore
 !else
  <font color=red>Danger!</font> <small>See notes below.</small>
 !endif
!endif
!if $new_usercnt>0
 <li>
 !if $sharing_user=$empty
  <input type=checkbox name=selection value=user>
 !endif
 $new_usercnt participant accounts. 
 !if $sharing_user!=$empty
  $no_restore
 !else
  <small>(Existing accounts: $old_usercnt.)</small>
 !endif
!endif
!if $new_doccnt>0
 <li>
 !if $sharing_doc=$empty
  <input type=checkbox name=selection value=doc>
 !endif
 $new_doccnt documents. 
 !if $sharing_doc!=$empty
  $no_restore
 !else
  <small>(Existing documents: $old_doccnt.)</small>
 !endif
!endif
!if $new_exocnt>0
 <li>
 !if $sharing_exo=$empty
  <input type=checkbox name=selection value=exo>
 !endif
 $new_exocnt exercises.
 !if $sharing_exo!=$empty
  $no_restore
 !else
  <small>(Existing exercises: $old_exocnt.)</small>
 !endif
!endif
!if $new_sheetcnt>0
 <li>
 !if $sharing_sheet=$empty
  <input type=checkbox name=selection value=sheet>
 !endif
 $new_sheetcnt work sheets. 
 !if $sharing_sheet!=$empty
  $no_restore
 !else
  Implies restoration of class exercises.
  <small>(Existing sheets: $old_sheetcnt.)</small>
 !endif
!endif
!if $new_examcnt>0
 <li>
 !if $sharing_exam=$empty
  <input type=checkbox name=selection value=exam>
 !endif
 $new_examcnt exam sheets.
 !if $sharing_exam!=$empty
  $no_restore
 !else
  Implies restoration of work sheets and exercises.
  <small>(Existing exams: $old_examcnt.)</small>
 !endif
!endif
!if $new_forumcnt>0
 <li>
 !if $sharing_forum=$empty
  <input type=checkbox name=selection value=forum>
 !endif
 $new_forumcnt forum messages. 
 !if $sharing_forum!=$empty
  $no_restore
 !else
  <small>(Existing messages: $old_forumcnt.)</small>
 !endif
!endif
!if $new_scorecnt>0
 <li><input type=checkbox name=selection value=score>
 Participant activity register and server-computed scores. Implies restoration
 of participant accounts.
!endif
!if $new_manualcnt>0
 <li><input type=checkbox name=selection value=manual>
 $new_manualcnt teacher-defined grades. <small>(Existing grades:
 $old_manualcnt.)</small>
!endif
</ul>
Restoration method:<ul>
<li><input type=radio name=restore value=replace checked>
 Replacement: replace existing corresponding resources by restored ones.
<li><input type=radio name=restore value=merge>
 Merge: replace existing corresponding resources except participant accounts and
 class exercises; for the latter, those with the same name will be replaced by
 restored data, while the others will remain.
</ul>
<input type=submit value="Restore the selected resources">
!href cmd=reply&job=list Abandon the restoration
.
</form>

<p><b>IMPORTANT</b>. 1. There is no check of integrity in your uploaded data,
and manual modification of the backup archives is not supported by the
system. Errors introduced by manual modification of archives will result
in unpredictable behavior of your class.
<p>
2. Whenever possible, avoid restoring 
<font color=red>class configuration</font> and
<font color=red>supervisor account</font>.
Errors in the uploaded data for these two fields may make you
completely lose control of your class.
<p>
3. You can use the backup of a class to install a new one. In this case,
avoid restoring scores and grades (server-computed and manual). These two
resources cannot be erased once they are installed (security measure).
And many class maintenance operations will be unavailable if there are
non-empty score data.

