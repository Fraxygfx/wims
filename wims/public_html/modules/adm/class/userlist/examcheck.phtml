
!read adm/title.phtml 1\
$classname\
$name_title_examcheck

!if _check isin $session
 !set error=bad_op
 !goto msg
!endif

!if $error!=$empty
 :msg
 <div class="msg">
  !read lang/msg.phtml.$moduclass_lang
 </div>
!else
 !if $checksessions=$empty
  <p class="no_exampart">
   $name_no_exampart
  </p>
 !else
  <p class="exampart">
   $name_exampart
  </p>
  $table_header
  $table_hdtr<th rowspan="2">$name_Session</th><th rowspan="2">$name_Exam</th><th rowspan="2">$name_Score<span class="small">/$scoremax</span></th>
  <th colspan="$maxexo">$name_Exercise </th><th rowspan="2">$name_Start</th></tr>
  $table_hdtr
   !for i=1 to $maxexo
    <th>$i</th>
   !next i
  </tr>
  !for ses in $checksessions
   !for x in $(exam$ses)
    $table_tr<td class="small">$ses</td>
    <td>$x</td>
    <td>$[rint($(score$(ses)$x)*$scoremax)/10]</td>
    !let nbx=!recordcnt wimshome/log/classes/$wims_class/exams/.exam$x
    !for i=1 to $nbx
      <td>
      !if $i isitemof $(exo$(ses)$x)
       !let s=!defof w_module_score in wimshome/log/classes/$wims_class/examlog/$checkuser/$ses/$x.$i
       !default s=0
       !href target=wims_check module=$module&cmd=new&job=examcheck&checkuser=$checkuser&checksession=$ses&checkexo=$x.$i&checkstep=1 $[rint($s*$scoremax)/10]
      !else
       &nbsp;
      !endif
     </td>
    !next i
    !if $nbx<$maxexo
     !for i=$[$nbx+1] to $maxexo
      <td style="background-image:url(gifs/bg/crossgrey.gif)">&nbsp;</td>
     !next i
    !endif
   !next x
   <td class="small">
    !read date.phtml $(start$(ses)$x)
   </td>
   </tr>
  !next sess
  $table_end
 !endif
!endif

!set wims_menu_items=!append line scores,1,cmd=reply&job=getuser&getuser=$checkuser\
to $wims_menu_items
!if $wims_user=supervisor
  !read adm/class/getnextuser $wims_class,$checkuser,examcheck,checkuser

 !set wims_menu_items=!append line ,0,\
 part_list,1,cmd=resume\
 to $wims_menu_items
!endif
