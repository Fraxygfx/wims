
!read adm/css.phtml
!read adm/class/classname.phtml $wims_classname\
$wims_institutionname

!read js/speckedit.phtml name_deposit
!header1


!read adm/title.phtml 1\
$classname\
$name_title

!if $error!=$empty
 <div class="wims_alertmsg">
 !read lang/msg.phtml.$moduclass_lang
 </div>
 <p>
 !href module=home $wims_name_class_home
. </p>
 !goto end
!endif

!if $job!=$empty
 !read $job.phtml
 !goto end
!endif

$name_Intro
!href style=student $name_home
.
<br />

<fieldset class="property_fields halfwidth blockcenter">
 <legend>$name_commun</legend>
 <textarea disabled="disabled" cols="70" rows="9">
  !record 0 of wimshome/log/classes/$wims_class/.motd
 </textarea>
  <br/>
  !set wims_ref_class=wims_button
    !href cmd=reply&job=modif&user=.CLASS. $wims_name_change
    &nbsp;
  !set wims_ref_class=wims_button wims_warning
    !href cmd=reply&job=delete&user=.CLASS. $wims_name_erase
</fieldset>

$name_motd
!reset table_center
!form reply

<fieldset class="property_fields halfwidth blockcenter">
 <legend>$name_grpaction</legend>
 $name_expert0
 <p>
  !set listuser=__CHECK__
  !set wims_ref_class=wims_formradio
  !formradio listuser list __ALL__ prompt $name_all
 </p>
 <p>
  !set wims_ref_class=wims_formradio
  !formradio listuser list __CHECK__ prompt $name_checked
 </p>
 <p>
  !set wims_ref_class=wims_formradio
  !formradio listuser list __FILTER__ prompt $name_filter
   !set wims_ref_class=wims_button_help float_right
 !href cmd=help&special_parm=filter $wims_name_help
  <br/>
  <textarea name="varfilter">$varfilter</textarea>
 </p>

 <div class="field box">
  <input type=hidden name="job" value="groupe">
  <input type="submit" name="action" value="$name_reactive" $wims_on_click/>
  <input type="submit" name="action" value="$name_change" $wims_on_click/>
  <input type="submit" name="action" value="$name_erase" $wims_on_click/>
  !if $wims_numpartconnected>0
      <input type="submit" name="action" value="$name_walertmsg" $wims_on_click/>
  !endif
 </div>
</fieldset>
$table_header
 $table_hdtr
  <th>Select</th>
  <th>$name_participant</th>
  <th style="width:50%">$name_actualmotd</th>
  <th>$wims_name_Status</th>
  <th>$name_alertmsg</th>
  <th>$name_aloneaction</th>
 </tr>
 !set listuser=$listuser
 !for k=1 to $nbuser
  $table_tr
   !let u=$(listiduser[$k])
   <td> <input type="checkbox" name="listuser" id="listuser$k" value="$u"/> <label for="listuser$k"></label> </td>
   <td>
    $(listnameuser[$k])
    !if $u isitemof $wims_connectedlogin
     <img src="gifs/themes/$wims_theme_icon/connected.png" width="15px" alt="connected" />
    !endif
   </td>
   <td>
    !record 0 of wimshome/log/classes/$wims_class/motd/$u
   </td>
   <td>
    !let test=!record 0 of wimshome/log/classes/$wims_class/motd/.$u
    !if $test=$empty
     $(name_status[1])
    !else
     $(name_status[2])
     !href cmd=reply&job=reactivate&listuser=$u $name_reactive
    !endif
   </td>
   <td>
    !let p=!positionof item $u in $wims_connectedlogin
    !if $p!=$empty
     !let n=!itemcnt $(wims_whoconnect[$p;])
     !if $n>4
      $name_usermultisession
     !else
      !defof wims_alertmsg in wimshome/sessions/$(wims_whoconnect[$p;4])/var.stat
     !endif
    !endif
   </td>
   <td>
   !set wims_ref_class=wims_button
    !href cmd=reply&job=modif&listuser=$u $wims_name_change
    &nbsp;
    !set wims_ref_class=wims_button wims_warning
    !href cmd=reply&job=delete&listuser=$u $wims_name_erase
    !if $n<5 and $p!=$empty
     &nbsp;
     !set wims_ref_class=wims_button
     !href cmd=reply&job=write&listuser=$u $name_walertmsg
    !endif
   </td>
  </tr>
 !next k
$table_end
!formend
:end

!if $job!=$empty and $job!=delete
  !set wims_menu_items=!append line back2,1,cmd=reply\
 to $wims_menu_items
!endif

!tail
!reset job
