!if $job=print
 !changeto print.phtml
!endif

!if $public!=P
 !changeto class.phtml
!endif

!header

!if $error!=$empty
 !read msg.phtml
 !tail
 !exit
!endif

!if $wims_user=supervisor and $job=raw
 Here is the source of the sheet. You may import it into your class using
 cut-and-paste.
 <p><hr><pre>
 !sh awk 'BEGIN {a=0};\
	/^:/ {a=1};\
	a==1 {print}' bases/sheet/$sh.def
 </pre><hr>
 <p>
 !href cmd=resume&job=read Back to normal view of the sheet.
 !tail
 !exit
!endif

<p><center><h3>$sheet_title<br>
<font size=-1>$sheet_desc</font></h3></center> <p>

$sheet_remark
<p>

!if $n=0
 The sheet is empty! This is probably an error.
!else
 Assigned works in this sheet:
 <p><ul>
 !for i=1 to $n
  !set ex=!record $i of $data
  !distribute lines $ex into di,pa,require,we,ti,de
  !set got=!word $i of $scores
  !set mean=!word $i of $means
  <p><li>$i. 
  !href module=$di&cmd=new&worksheet=$public$shn&$pa $ti
, $de
!!  !if $require>0
!!   <small>$[$got] out of $[$require] points obtained, quality
!!   $[$mean]/10.</small>
!!  !endif
 !next i
 </ul>
 !if $wims_user=supervisor
  !href cmd=resly&job=import Import
  this sheet into your class, or
  !href cmd=reply&job=raw show the source
  of the sheet.
  <p>
 !endif
!endif
!href cmd=reply&job=print Printable version
.

!tail

